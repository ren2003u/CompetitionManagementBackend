(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e7c68b18"],{2227:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return c}));var a=n("b775");function i(){return Object(a["a"])({url:"/team/list",method:"get"})}function r(e){return Object(a["a"])({url:"/team/byname/"+e,method:"get"})}function s(e){return Object(a["a"])({url:"/team/addOrUpdate",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/team/addOrUpdate",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/team/delete/"+e,method:"delete"})}function m(e){return Object(a["a"])({url:"/user/searchUsersByTeamName?team_name="+e,method:"post"})}function c(){return Object(a["a"])({url:"/team/getRankByTeamCollege",method:"get"})}},"897c":function(e,t,n){},9406:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",[n("el-carousel",{attrs:{interval:4e3,type:"card",height:"200px"}},e._l(6,(function(t){return n("el-carousel-item",{key:t},[n("h3",{staticClass:"medium"},[e._v(e._s(t))])])})),1)],1)]),n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("活动详情")]),n("el-button",{staticStyle:{float:"right",margin:"auto 0"},attrs:{icon:"el-icon-plus",type:"text",disabled:"admin"!=e.inf.status},on:{click:function(t){return e.handleAdd()}}},[e._v("新增活动")])],1),n("div",[n("el-table",{staticStyle:{width:"100%",border:"1px solid #ebeef5"},attrs:{data:e.eventsList,stripe:"",height:"300"}},[n("el-table-column",{attrs:{label:"#",align:"center",type:"index",width:"80"}}),n("el-table-column",{attrs:{label:"活动名称",prop:"event_name",align:"center"}}),n("el-table-column",{attrs:{label:"活动时间",prop:"event_time",align:"center"}}),n("el-table-column",{attrs:{prop:"statu",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return["0"===a.statu?n("el-tag",{attrs:{size:"medium"}},[e._v("进行中")]):e._e(),"1"===a.statu?n("el-tag",{attrs:{size:"medium",type:"info"}},[e._v("未开始")]):e._e(),"2"===a.statu?n("el-tag",{attrs:{size:"medium",type:"danger"}},[e._v("已结束")]):e._e()]}}])}),n("el-table-column",{attrs:{label:"活动地点",prop:"event_location",align:"center"}}),n("el-table-column",{attrs:{prop:"operate",label:"操作",width:"350",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e.isInEventTeamList(a)?n("el-button",{attrs:{size:"mini",icon:"el-icon-minus",type:"warning",plain:"",disabled:"0"!==a.statu||"captain"!=e.inf.status||void 0==e.inf.team_name||""==e.inf.team_name},on:{click:function(t){return e.handleWithdrawEvent(a)}}},[e._v("退赛")]):n("el-button",{attrs:{size:"mini",icon:"el-icon-plus",plain:"",disabled:"0"!==a.statu||"captain"!=e.inf.status||void 0==e.inf.team_name||""==e.inf.team_name},on:{click:function(t){return e.handleAddEvent(a)}}},[e._v("参赛")]),n("el-button",{attrs:{size:"mini",icon:"el-icon-info",type:"info",plain:""},on:{click:function(t){return e.handleInfo(a)}}},[e._v("信息")]),n("el-button",{attrs:{size:"mini",icon:"el-icon-edit",type:"primary",plain:"",disabled:"admin"!=e.inf.status},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]),n("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger",plain:"",disabled:"admin"!=e.inf.status},on:{click:function(t){return e.handleDel(a)}}},[e._v("删除")])]}}])})],1)],1)]),n("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"35%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{attrs:{"label-width":"80px",model:e.form}},["新增活动"!==e.dialogTitle?n("el-form-item",{attrs:{label:"活动编号"}},[n("el-input",{attrs:{disabled:""},model:{value:e.form.event_number,callback:function(t){e.$set(e.form,"event_number",t)},expression:"form.event_number"}})],1):e._e(),n("el-form-item",{attrs:{label:"活动名称"}},[n("el-input",{attrs:{disabled:"新增活动"!==e.dialogTitle},model:{value:e.form.event_name,callback:function(t){e.$set(e.form,"event_name",t)},expression:"form.event_name"}})],1),n("el-form-item",{attrs:{label:"活动时间"}},[n("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1),n("el-form-item",{attrs:{label:"活动地点"}},[n("el-input",{model:{value:e.form.event_location,callback:function(t){e.$set(e.form,"event_location",t)},expression:"form.event_location"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("确 定")]),n("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("取 消")])],1)],1),n("el-drawer",{attrs:{title:e.drawerTitle,visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[e._v("参赛队伍")])]),n("div",[n("el-table",{attrs:{data:e.teamList,height:"500"}},[n("el-table-column",{attrs:{type:"index",label:"#",align:"center"}}),n("el-table-column",{attrs:{label:"队名",prop:"team_name",align:"center"}}),n("el-table-column",{attrs:{label:"队长",prop:"teamLeader",align:"center"}}),n("el-table-column",{attrs:{label:"队员1",prop:"teamMember_1",align:"center"}}),n("el-table-column",{attrs:{label:"队员2",prop:"teamMember_2",align:"center"}})],1)],1)])],1)],1)},i=[],r=(n("caad"),n("2532"),n("b775"));function s(){return Object(r["a"])({url:"/events/list",method:"get"})}function o(e){return Object(r["a"])({url:"events/byname/"+e,method:"get"})}function l(e){return Object(r["a"])({url:"events/addOrUpdate",method:"post",data:e})}function m(e){return Object(r["a"])({url:"events/addOrUpdate",method:"put",data:e})}function c(e){return Object(r["a"])({url:"events/delete/"+e,method:"delete"})}var u=n("2227"),d=n("c24f");function f(e){return Object(r["a"])({url:"/event-team/event/"+e,method:"get"})}function v(e){return Object(r["a"])({url:"/event-team/joinEvent?",method:"post",data:e})}function h(e){return Object(r["a"])({url:"/event-team/withdrawFromEvent?event_number="+e.event_number+"&team_name="+e.team_name,method:"post"})}var b={data:function(){return{inf:{},drawerTitle:void 0,drawer:!1,time:void 0,dialogTitle:void 0,form:{},dialogVisible:!1,teamList:[],eventsList:[],teamInfList:[],flag:!1}},created:function(){this.getList(),this.getInf()},methods:{isInEventTeamList:function(e){var t=this;return f(e.event_number).then((function(e){var n=e.data;n.includes(t.inf.team_name)&&(t.flag=!0)})),this.flag},handleInfo:function(e){this.drawerTitle=e.event_name,this.drawer=!0,this.teamList=[],this.teamInfList=[],this.teamList=e.teamList},getInf:function(){var e=this;Object(d["e"])().then((function(t){e.inf=t.data}))},getList:function(){var e=this;s().then((function(t){e.eventsList=t.data;for(var n=function(t){e.time=e.eventsList[t].event_time.split("~"),e.eventsList[t].statu=e.getTimePosition(e.time[0],e.time[1]),e.eventsList[t].teamList=[],f(e.eventsList[t].event_number).then((function(n){for(var a=n.data,i=function(){var n={};n.team_name=a[r],n.teamLeader="",n.teamMember_1="",n.teamMember_2="",Object(u["f"])(a[r]).then((function(e){for(var t=e.data,a=0;a<t.length;a++)"captain"===t[a].status?n.teamLeader=t[a].username:""==n.teamMember_1?n.teamMember_1=e.data[a].username:n.teamMember_2=e.data[a].username;""==n.teamLeader&&(n.teamLeader="（空缺）"),""==n.teamMember_1&&(n.teamMember_1="（空缺）"),""==n.teamMember_2&&(n.teamMember_2="（空缺）")})),e.eventsList[t].teamList.push(n)},r=0;r<a.length;r++)i()}))},a=0;a<e.eventsList.length;a++)n(a)}))},resetForm:function(){this.time=void 0,this.form={event_number:void 0,event_name:void 0,event_time:void 0,event_statu:void 0,event_location:void 0}},getTimePosition:function(e,t){var n=new Date,a=e.split("-"),i=t.split("-"),r=new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2])),s=new Date(parseInt(i[0]),parseInt(i[1])-1,parseInt(i[2]));return n<r?"1":n>s?"2":"0"},handleEdit:function(e){var t=this;this.dialogTitle="编辑活动",this.resetForm(),this.time=e.event_time.split("~"),o(e.event_name).then((function(e){t.form=e.data,t.dialogVisible=!0}))},handleDel:function(e){var t=this;this.dialogVisible=!1,this.$confirm("你确定删除活动".concat(e.event_name,"吗?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){c(e.event_number).then((function(e){t.$message({type:"success",message:"删除成功"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleAdd:function(){this.resetForm(),this.dialogVisible=!0,this.dialogTitle="新增活动"},submit:function(){var e=this;this.form.event_time=this.time[0]+"~"+this.time[1],void 0!==this.form.event_number?m(this.form).then((function(t){e.$message({type:"success",message:"修改成功!"}),e.dialogVisible=!1,e.getList()})):(this.form.event_time=this.time[0]+"~"+this.time[1],l(this.form).then((function(t){e.$message({type:"success",message:"新增成功!"}),e.dialogVisible=!1,e.getList()})))},cancel:function(){this.dialogVisible=!1,this.resetForm()},handleAddEvent:function(e){var t=this,n=this.inf.team_name,a=e.event_number;this.$confirm("是否选择加入"+e.event_name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){v({event_number:a,team_name:n}).then((function(e){-1!=e.code?(t.$message({type:"success",message:"参赛成功!"}),t.getInf(),t.getList()):t.$message.error(e.msg)}))})).catch((function(){t.$message({type:"info",message:"已取消参赛"})}))},handleWithdrawEvent:function(e){var t=this,n=this.inf.team_name,a=e.event_number;this.$confirm("是否选择退出"+e.event_name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){h({event_number:a,team_name:n}).then((function(e){-1!=e.code?(t.$message({type:"success",message:"退赛成功!"}),t.getInf(),t.getList()):t.$message.error(e.msg)}))})).catch((function(){t.$message({type:"info",message:"已取消退赛"})}))}}},p=b,g=(n("d1ca"),n("2877")),_=Object(g["a"])(p,a,i,!1,null,null,null);t["default"]=_.exports},d1ca:function(e,t,n){"use strict";n("897c")}}]);